### 테스트란?

- 소프트웨어 개발에서 시스템, 애플리케이션, 또는 코드의 동작을 검증하고 확인하는 과정 및 행위
- 테스트를 그럼 왜 하는가? 테스트 코드가 아니여도 테스트 할 수 있는 방법은 많은데
    - 테스트, 즉, 설계에 최대한 많은 시간을 쏟을수록 수정사항이 적어지고 전체 개발 시간을 줄일 수 있기 때문에
        - 테스트는 설계도의 역할도 수행
        - 테스트 코드는 전체 개발 중 20%에 해당하는 기능 개발에 조금 더 공을 들이는 대신에 80%에 해당하는 설계, 유지보수에서 비용 이점을 얻어서 들인 공보다 이득을 보려는 전략
    - 기능들이 늘어나고 서로 영향을 주기 시작하면 한 가지 기능을 수정하기 위해 봐야 할 코드의 양이 늘어남
    - 기능 수정 및 배포에 개발자들이 자신감을 가질 수 있음

### 테스트 주도 개발 (TDD)이란?

- 소프트웨어 개발 방법론 중 하나로 코드 작성 전에 테스트를 먼저 작성하는 방식
- 기능을 구현하기 전에 해당 기능을 검증하는 테스트 코드를 작성함으로써, 코드 품질을 높히고 개발 효율성을 극대화하는데 중점을 둠
- 과정
    - 테스트 작성
        - 구현하려는 기능에 대한 테스트 코드를 작성
        - 테스트는 실패(아직 해당 기능이 구현되지 않음)
    - 코드 작성
        - 테스트를 통과하기 위한 최소한의 코드를 작성
        - 테스트를 통과하는 것에만 집중
    - 리팩토링
        - 테스트를 통과한 코드를 더 나은 구조로 개선
        - 모든 테스트가 여전히 통과하는지 확인
    - 반복
        - 새로운 기능이나 요구사항이 생기면 다시 테스트를 작성하고 위의 과정 반복
- 장점
    - 테스트를 먼저 작성함으로써, 무엇을 구현해야 하는지 명확해짐
    - 테스트를 기반으로 코드를 작성하기 때문에, 초기 설계 단계에서 많은 시간을 투자

### JUnit5

- 각 테스트 메서드를 독립적으로 실행하기 위해 테스트 클래스의 새로운 인스턴스 생성
    - 테스트들 간의 상태 공유를 방지하고, 테스트 독립성 보장, 특정 테스트가 다른 테스트에 의해 실패하는 상황을 방지
        - 테스트 격리를 보장하며, 테스트가 실행될 때마다 새 인스턴스가 생성되므로, 테스트 간에 공유되는 상태나 사이드 이펙트가 없앨 수 있음
### 테스트의 구성 요소

- 테스트 대상
    - 테스트하려는 시스템의 특정 부분
    - 메서드, 클래스, 모듈, 전체(통합) 시스템일 수 있음
- 테스트
    - **Arrange (준비)**: 테스트를 실행하기 위해 필요한 모든 사전 조건과 준비 작업을 설정합니다.
    - **Act (실행)**: SUT를 호출하여 테스트 동작을 실행합니다.
    - **Assert (검증)**: SUT의 동작 결과가 기대한 결과와 일치하는지 확인합니다.
- 협력자 (Collaborators)
    - SUT가 의존하는 객체들
    - 협력자는 테스트 대상과 상호작용하며, 테스트에서 중요한 역할
    - 협력자는 실제 객체일 수도 있고, 테스트를 위해 만들어진 임포스터(테스트 더블)일 수도

### 테스트 더블

- **Dummy 객체**
    - 사용되지만, 아무 일도 하지 않는 객체. 주로 매개변수로 전달될 때 사용
    - 예: `null`이나 기본 생성자로 만든 객체.
- **Stub (스텁)**
    - 미리 정의된 결과를 반환하도록 설정된 객체. 주로 특정 메서드 호출에 대해 일정한 응답을 반환
    - 예: 데이터베이스 쿼리의 결과를 미리 정의된 값으로 반환하는 객체
    - 테스트에서 자주 사용하는 Mockito 프레임워크도 Stub와 같은 역할
- **Spy (스파이)**
    - 실제 객체처럼 동작하지만, 호출된 메서드와 그 인수들을 기록하여 검증할 수 있는 객체
    - 예: 메서드 호출 횟수나 호출된 매개변수를 검증할 때 사용.
    - Mockito 프레임워크의 `verify()` 메서드가 같은 역할
- **Mock (모크)**
    - 기대되는 호출과 반환값을 설정하고, 호출된 메서드와 그 매개변수를 검증할 수 있는 객체. 모의 객체는 테스트 중에 특정 행위가 발생했는지 검증 가능
    - 예: 특정 메서드가 정해진 횟수만큼 호출되었는지 확인.
    - Mockito 프레임워크가 대표적인 Mock 프레임워크
- **Fake (페이크)**
    - 실제 구현을 가지지만, 단순화된 버전으로 구현된 객체. 주로 실제 환경을 모방하여 동작하지만, 더 단순하고 빠르게 작동
    - 예: 인메모리 데이터베이스로 작동하는 객체.

- **`BigDecimal`은 소수점 이하의 유효자리수를 고려하기 때문에, `isEqualByComparingTo` 메서드를 사용하여 비교하는 것이 더 정확**

### 테스트 DI

- 수동 DI
    - 테스트용 협력자나 의존 객체를 테스트 대상 객체에 직접 주입하는 방식
    - 테스트에서 사용할 객체를 명확히 하고, 외부 프레임워크에 의존하지 않으므로 간단하고 빠름
- 스프링 DI
    - 스프링 프레임워크의 구성 정보를 이용하여 테스트용 협력자나 의존 객체를 주입하는 방식
    - 애플리케이션 컨텍스트를 구성하고, 컨테이너로부터 테스트 대상을 가져와서 테스트
    - **`@ContextConfiguration`**, **`@Autowired`**